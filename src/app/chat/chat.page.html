<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>chat</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Chat</ion-title>
    </ion-toolbar>
  </ion-header>

  <ion-grid>
    <ion-col>
      <form style="display: flex;" #f="ngForm" (ngSubmit)="onSubmit(f)">
        <ion-input (click)="removeLine()" style="border: solid 2px grey; border-radius: 15px;" ngModel
          aria-placeholder="Search ..." name="search" type="text" required></ion-input>
        <button
          style="padding: 0 15px; margin-left: 10px; border-radius: 5px; background: #0083fa; font-weight: 600; font-size: 16px;"
          type="submit">Search</button>
      </form>
      <ion-button id="open-modal" expand="block">
        <ion-icon slot="start" name="people-outline"></ion-icon>
        new group chat
      </ion-button>
      <ion-list lines="none">
        <ion-item style="display: flex; cursor: pointer;" *ngFor="let user of shown"
          (click)="navigateToChat(user.username)">
          <img style="border-radius: 50%; margin-right: 15px;" width="40" height="40"
            src="https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/default-avatar.png" alt="User">
          <p style="font-size: 18px;">{{ user.username }}</p>
        </ion-item>
        <ion-item style="display: flex; cursor: pointer;" *ngFor="let user_group of user_groups"
          (click)="navigateToGroupChat(user_group._id)">
          <div
            style="background-color: #8993a4; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
            <ion-icon name="people" style="font-size: 30px; color:white"></ion-icon>
          </div>



          <p style="font-size: 18px; padding :0rem 1rem;">{{ user_group.name }}</p>
        </ion-item>
      </ion-list>
    </ion-col>
  </ion-grid>
</ion-content>

<ion-modal trigger="open-modal" (willDismiss)="onWillDismiss($event)">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-buttons slot="start">
          <ion-button (click)="cancel()">Cancel</ion-button>
        </ion-buttons>
        <ion-title>Welcome</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="confirm()" [strong]="true">Confirm</ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    <ion-content class="ion-padding">
      <ion-item>
        <ion-input label="Enter your group chat name" labelPlacement="stacked" type="text" placeholder="enter a name"
          [(ngModel)]="group_name"></ion-input>
      </ion-item>
      <ion-item-divider>

      </ion-item-divider>
      <ion-item>
        <ion-label>Users</ion-label>
      </ion-item>
      <ion-list>
        <ion-item>
          <ion-select aria-label="Fruit" (ionChange)="handleChange($event)"
            placeholder="Select the users you want to add to group chat" [multiple]="true">
            <ion-select-option *ngFor="let user of users" [value]="user._id">
              {{ user.username}}
            </ion-select-option>
          </ion-select>
        </ion-item>
      </ion-list>
    </ion-content>
  </ng-template>
</ion-modal>
